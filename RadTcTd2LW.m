function [lw, e, C_c, C_d] = RadTcTd2LW(v, G, O, K, tc, td, k);%%function [lw, e, C_c, C_d] = RadTcTd2LW(mv, G, O, K, tc, td);%----------------------------------------------------%%input%  v = Rad ADC output in mV (typ -300 mv)%  G = preamp gain (typ 825)%  O = preamp offset (typ < 20 mv)%  K = PIR calibration (typ 3.9e-6 V/W/m^2)%  tc = case degC%  td = dome degC%  no arguments ==> test mode%output%  lw = corrected longwave flux, W/m^2%  e = thermopile irradiance W/m^2%  C_c C_d = corrections for case and dome, w/m^2%-------------------------------------------------------%000928 changes eps to 0.98 per {fairall98}%010323 back to 1.0 per Fairall %100113 adapted from PirTcTd2LW.mk=4;% compute thermopile radiatione = (v-O)/G/1000/K;% THE CORRECTION IS BASED ON THE TEMPERATURES ONLYTc = tc+273.15;Td = td+273.15;eps = 1;sigma = 5.67e-8;C_c = eps .* sigma .* Tc .^ 4;C_d =  - k .* sigma .* (Td .^ 4 - Tc .^ 4);lw = e + C_c + C_d;return