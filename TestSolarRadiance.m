%TestSolarRadiance - clear% Yaphank% lat = 40.8333; % lon = -72.9833;% yyyy = 1998;% MM = 11;% dd = 5;% hh = 21;% mm=42;% ss=58;% Gasexlat = 40;lon = -10;yyyy = 1998;  MM=5; dd=11;dt = datenum(yyyy,MM,dd,0,0,0);[yr,jdf] = dt2jdf(dt);jd = fix(jdf);% SINGLE POINT% hrf = hh + mm/60 + ss/3600;% FULL DAYhrf = [0:1/60:23.99]';watvap = 0;k1 = .3;k2 = .3;p = 1013;ozone = 0;[sw,sz,saz,dir,sky] = SolarRadiance(lat,lon,jd, hrf, watvap,p,k1,k2,ozone);%SINGLE POINT% fprintf('azimuth = %.1f\n',saz);% fprintf('elev = %.1f\n',90-sz);%====================% PLOT WHOLE DAY%================jdf = jd + hrf/24;dt = jdf2dt(yr,jdf);subplot(3,1,1)plot(dt,90-sz);  datetick;ylabel('Elevation (deg)');gridsubplot(3,1,2)plot(dt,saz); datetick;ylabel('Azimuth (deg)');gridsubplot(3,1,3)plot(dt,sw); datetick;ylabel('W/m^2');gridfigure(gcf);