function [plothandle] = PlotDir(t,x,plotstyle)%PLOTDIR -- direction plot, no 0-360 jumps%========================================================================%     [plhandles] = PlotDir(t,x)%% Plots a time series was a group of segments the make proper crossing% around 0 and 360 deg.%%input:% 't' is the 'x' vector% 'x' is the 'y' (vertical vector)%output:%  plothandle is an array of handles for all segments%  rmr 030614%========================================================================if nargin == 2,   plotstyle = '''color'',''b''';end%%%%%%%%%%% definitions for convenience%%%%%%%%%%%%tmin = t(1); tmax = t(end);xmin = 0;  xmax = 360;jumpsize = 0.6 .* (xmax - xmin);% FIND THE JUMP STRINGSdx = diff(x);						% jumps greater than the set jumpsizeiup = find(dx >= jumpsize);			% index of positive jumps greater than the jump sizeidn = find(dx <= -jumpsize);		% index of negative jumps greater than jump sizeijump = find(abs(dx) >= jumpsize);	% index of all pos or neg jumps >= jumpsize	nup = length(iup);					% number of up jumpsndn = length(idn);					% number of down jumpsnser = length(ijump) + 1;			% number of all jumps + 1% OUTPUT SET OF PLOT HANDLESplothandle = [];% PLOT ALL PARTIAL SERIESif(nser <= 1)	plothandle = plot(t,x);else,	% first segment	plothandle = plot(t(1:ijump(1)), x(1:ijump(1)));	c=sprintf('set(plothandle,%s);',plotstyle);	disp(c);	eval(c);		% all the rest of the segments	hold on	for	iser = 2:nser-1,		P1 = plot(t(ijump(iser-1)+1:ijump(iser)),x(ijump(iser-1)+1:ijump(iser)) );% 		eval(['set(P1,' plotstyle ');']);		plothandle = [plothandle; P1];	end		% last segment	P1 = plot(t(ijump(nser-1)+1:length(x)),x(ijump(nser-1)+1:length(x)));% 	eval(['set(P1,' plotstyle ');']);	plothandle = [plothandle; P1];	% all up bits to the 360 degree top	t1 = t(iup);	t2 = t(iup+1);	x1 = x(iup);	x2 = x(iup+1);	tx = (t2-t1) .* (xmin - x1) ./ (x2 - (xmax - xmin) - x1) + t1;	ta = [t1, tx];	xa = [x1, xmin .* ones(length(x1),1)];	P1 = plot(ta',xa');% 	eval(['set(P1,' plotstyle ');']);	plothandle = [plothandle; P1];		ta = [tx, t2];	xa = [xmax .* ones(length(x1),1), x2];	P1 = plot(ta',xa');	%eval(['set(P1,' plotstyle ');']);	plothandle = [plothandle; P1];	% down bits to the bottom	t1 = t(idn);	t2 = t(idn+1);	x1 = x(idn);	x2 = x(idn+1);	tx = (t2-t1) .* (xmax - x1) ./ (x2 + (xmax - xmin) - x1) + t1;	ta = [t1, tx];	xa = [x1, xmax .* ones(length(x1),1)];	P1 = plot(ta',xa');	%eval(['set(P1,' plotstyle ');']);	plothandle = [plothandle; P1];		ta = [tx, t2];	xa = [xmin .* ones(length(x1),1), x2];	P1 = plot(ta',xa');	%eval(['set(P1,' plotstyle ');']);	plothandle = [plothandle; P1];		hold  offendreturn