function [rh, ws, w, e, es] = TTwP2rh(t, tw, p)%TTWP2RH -- compute RH and humidity vars from dry and wet-bulb%        [rh, td, w, ws, e, es] = TTwP2rh(t, tw, p)%input%  t = air temp in degC%  tw = wet bulb temp in degC%  p = pressure in mbar%output%  rh = relative humidity%  w = mix ratio (fraction)%  ws = saturation mix ratio%  e = vapor pressure  (mbar)%  es = saturation vap pressure (mbar)%%Reynolds, 970220% test conditions% t = 28.9;  tw = 25.7;  p = 1005.4;% rh should be 77.4%% convert to degKtk = t + 273.15 * ones(size(t));twk = tw + 273.15 * ones(size(t));% compute the saturation vap pressurees = esatwat2(t);  % hPaesw = esatwat2(tw);  % hPa% compute the saturation mixing ratiows = mixratio(es,p);% compute the actual vap pressure (mbar) -> Pae = esw - p .* (tk-twk) .* ...	(0.00066 .* (.6859*ones(size(t)) + 0.00115 .* twk));rh = 100 .* e ./ es;w = mixratio(e, p);return;