function VecStickPlot(dt, s,d,lbl,yposrel,vscle,clr,ax,linewidth);% function VecStickPlot PLOT A HORIZONTAL LINE AT POSITION ypos%        VecStickPlot(dt, s, d,lbl,yposrel,vscle,clr,ax);% input: %  dt = datetime%  s & d are vector magnitude and direction%  lbl = label on left hand side, default = ''%  yposrel = rel y position of the plot, default = 0.5%  vscle = speed equivalent to the full vertical axis, default = 50%  clr = color of the sticks, default = 'k'%  ax = axis handle.  Default = 'gca');% BEFORE CALLING THIS FUNCTION%  Define a figure and axis.%  define a title etc.%  This function will plot a vertical liine of sticks across the plot.% rmr 030603if nargin < 8, ax = gca; endif nargin < 7, clr = 'k'; endif nargin < 6, vscle = 50; endif nargin < 5, yposrel = 0.5; endif nargin < 4, lbl = ' '; end[u,v] = VecP2V(s,d);set(gca,'ylim',[-vscle,vscle]);fprintf('set gca ylim = -%d, %d\n', vscle, vscle);xlim = get(ax,'xlim');ylim = get(ax,'ylim');xscale = diff(xlim)/diff(ylim);dtu = dt + u .* xscale ./ 2;vbase = ylim(1)+yposrel*diff(ylim);% stick base% ypos = y plot position for base line.pl = plot([xlim(1) xlim(2)], [vbase,vbase],clr);hold onfor i = 1:length(dt),	pl = plot([dt(i),dtu(i)],[vbase,v(i)+vbase]);	set(pl,'linewidth',linewidth,'color',clr);endhold offtx = text(0,0,lbl);set(tx,'units','normalized','position',[.05, .9],'fontweight','bold',...'fontsize',10,'horizontalalignment','left','verticalalignment','middle');set(ax,'xlim',xlim,'ylim',ylim);return