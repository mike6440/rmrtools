function a = limits(x),%LIMITS -- find true limits to a series removing NaNs%			function a = limits(x),% x = input vector or matrixx% a = [min; max] for the vector (2x1)% if input x = mxn matrix, the limits will be for each column.%    in this case a is (2xn)%Reynolds -- 970216% check on the size and shape of the input matrix.sz = size(x);% if a row vector convert to columnif sz(1) == 1, x = x';  sz = size(x); end% number of columns to analyzenc = sz(2);% column-by-column operationfor i = 1:nc,	b = 0;	c = x(:,i);	ix = isnan(c);	if length(ix) > 0,		c(ix) = [];	end		if length(c) > 0		b = min(c);		b = [b; max(c)];	else		b = [NaN; NaN];	end	if i == 1, a = b;   else a = [a b];  endendreturn;