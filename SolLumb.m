function Fs = SolLumb(lat, lon, julday, gmt)% SolLumb			Lumb's clear-sky solar radiation.%			Fs = SolLumb(lat, lon, julday, gmt)%INPUT:  lat -- latitude in decimal degrees (1x1)%        lon -- longitude in decimal degrees (1x1)%        julday -- julian day, (nx1)%        gmt -- Universal time (mx1)% Reynolds, 970204%lat = 44.3;%lon = 9;%julday = [1:365]';%gmt = 12;%  sizes of the input vectorsm = length(gmt);n = length(julday);%  convert to radianslatq = lat * pi / 180;longq = lon * pi / 180;% setup m x n matricies for computation of Fs (mxn)daystep = floor(gmt ./ 24) * ones(1,n);z = rem(gmt,24) * ones(1,n);jd = ones(m,1) * julday';% angle of declination:decangle = 0.41 .* sin(2*pi .* (jd - 80)/365);% hour angle: hourangle = 0.262 .* (z-12) - longq;sinphis = sin(latq) .* sin(decangle)...    + cos(latq) .* cos(decangle) .* cos(hourangle);% Lumb's equation --Fs = 1352 .* sinphis .* ( 0.61 + 0.20 .* sinphis);%  remove all negative numbersix = find(Fs <= 0);if length(ix) > 0  Fs(ix) = zeros(length(ix),1);endreturn