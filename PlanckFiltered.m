function [b,kt15sn] = PlanckFiltered(T),
% function [b,kt15sn] = PlanckFiltered(T),
% Compute the Output from a radiometer with filtering window
% 140410  in development
% see wallace & hobbs p287
% see PlanckLaw.m
%function Bf = PlanckLaw(T,lambda,wlambda),
%Input
% T = target abs temperature, repeat absolute temperature
% lambda(i), i=1,2,...N = wavelength array in m
% w(i) = the window response for lambda(i).
%Output
% B in W sr^-1 m^-2  integrated over the optical band
% kt15sn string serial number of the kt15 used.

b=[];
%T=[10:40]'+273.15;
c1=3.74186e-16;
c2=.01439;


%==== ROSR3 ===============================================
%KT15 SERIAL NUMBER: 11935
%16 05 06		
%KT15.85 SN11935		
%      12.SPK        Pyroelektrischer Detektor (LiTaO3)		
%     160.SPK        9.6 - 11.5		
%kt15sn='11935'; % !!
%f = [ ...
%9.28	11.8
%9.31	0.357667
%9.37	3.002402
%9.43	6.337686
%9.49	10.413117
%9.55	16.306198
%9.61	25.963547
%9.67	36.458515
%9.73	46.351946
%9.79	51.277052
%9.85	54.747181
%9.91	58.067127
%9.97	59.610657
%10.03	59.555529
%10.09	59.521989
%10.15	59.799777
%10.21	60.771412
%10.27	61.802468
%10.33	62.807971
%10.39	63.671959
%10.45	64.496884
%10.51	65.209094
%10.57	65.209094
%10.63	65.924249
%10.69	66.522749
%10.75	67.121249
%10.81	67.451023
%10.87	66.894956
%10.93	66.25033
%10.99	65.625707
%11.05	65.522968
%11.11	65.577193
%11.17	65.622867
%11.23	66.302045
%11.29	67.630746
%11.35	68.972272
%11.41	66.407322
%11.47	50.950737
%11.53	34.240797
%11.59	17.971729
%11.65	10.918391
%11.71	6.826609
%11.77	2.828826
%];
	
%========= ISAR4 ===================================================
%16 05 11		
%KT15.85 SN11971		
%12.SPK        Pyroelektrischer Detektor (LiTaO3)		
%160.SPK        9.6 - 11.5		
%9.4	11.26
%xx
%xx
kt15sn='11973';

f=[ 9.43	2.54631
9.49	5.793331
9.55	9.668717
9.61	14.968266
9.67	24.493301
9.73	34.960308
9.79	45.626378
9.85	50.791858
9.91	54.246059
9.97	57.81366
10.03	59.618147
10.09	59.564821
10.15	59.498671
10.21	59.664674
10.27	67.451023
10.33	66.894956
10.39	66.25033
10.45	65.625707
10.51	65.522968
10.57	65.577193
10.63	65.622867
10.69	66.302045
10.75	67.630746
10.81	68.972272
10.87	66.407322
10.93	50.950737
10.99	34.240797
11.05	17.971729
11.11	10.918391
11.17	6.826609
11.23	2.828826
];

%====ROSR2 ==========================================================
%KT15 SERIAL NUMBER: 11733
%9/16/15				
%KT15.85 SN11733				
%      12.SPK        Pyroelektrischer Detektor (LiTaO3)				
%     160.SPK        9.6 - 11.5				
%				
%				
%								
%kt15sn='11733'; % !!
%f = [ ...
%9.43	2.54631		
%9.49	5.793331		
%9.55	9.668717		
%9.61	14.968266		
%9.67	24.493301		
%9.73	34.960308		
%9.79	45.626378		
%9.85	50.791858		
%9.91	54.246059		
%9.97	57.81366		
%10.03	59.618147		
%10.09	59.564821		
%10.15	59.498671		
%10.21	59.664674		
%10.27	60.626505		
%10.33	61.658131		
%10.39	66.661415		
%10.45	67.197654		
%10.51	67.322188		
%10.57	66.745603		
%10.63	66.105611		
%10.69	65.601903		
%10.75	65.535531		
%10.81	65.587775		
%10.87	65.780225		
%10.93	66.609891		
%10.99	67.941563		
%11.05	68.378		
%11.11	62.826194		
%11.17	47.07922		
%11.23	30.471426		
%11.29	16.337545		
%11.35	9.970368		
%11.41	5.900365		
%11.47	2.173417		
%];


%====ROSR1===========================================================
%%ROSR01 KT15 RESPONSE
%%"26.11.2014"
%%"KT15.85 SN11486"
%%"      12.SPK        Pyroelektrischer Detektor (LiTaO3)"
%%"     160.SPK        9.6 - 11.5"
%%""
%%""
%%""
%%""
%!! kt15sn='11486'; % !!
%f = [ ...
%9.43	2.54631
%9.49	5.793331
%9.55	9.668717
%9.61	14.968266
%9.67	24.493301
%9.73	34.960308
%9.79	45.626378
%9.85	50.791858
%9.91	54.246059
%9.97	57.81366
%10.03	59.618147
%10.09	59.564821
%10.15	59.498671
%10.21	59.664674
%10.27	67.451023
%10.33	66.894956
%10.39	66.25033
%10.45	65.625707
%10.51	65.522968
%10.57	65.577193
%10.63	65.622867
%10.69	66.302045
%10.75	67.630746
%10.81	68.972272
%10.87	66.407322
%10.93	50.950737
%10.99	34.240797
%11.05	17.971729
%11.11	10.918391
%11.17	6.826609
%11.23	2.828826
%      ];

lambda=f(:,1)*1e-6;
w=f(:,2);

for i=1:length(T),
	[k]=PlanckLaw(T(i),lambda);
	kw = k .* w;
	b = [b; sum(kw) ./ sum(w)];
end

return;

