function MixR = mixratio(Pvap,Pbaro)%MIXRATIO -- Mix ratio from vap pressure and pressure%=============================================================%    MixR = mixratio(Pvap,Pbaro)%%input:  %  Pvap -- vapor partial pressure (Pa or mbar)%  Pbaro -- barometric pressure (Pa or mbar)%     may be a (1x1) scalar.%output:% mixratio as a fraction;%% Reynolds, 981117%==============================================================% if Pbaro is zero, missing, use 1000 mbar.if nargin == 1,	Pbaro = 100000 * ones(size(Pvap));elseif nargin == 2,	if length(Pbaro) == 1,		Pbaro = Pbaro*ones(size(Pvap));	endelse	fprintf('Improper arguments in mixratio()\n');	return;end% CONVERT PBARO TO PASCAL IF IN MBAR% all non-nan valuesix = find( ~isnan(Pbaro) );% are there some good values? then checkif length(ix) > 0,	if max(Pbaro(ix)) < 90000,		Pbaro(ix) = Pbaro(ix) .* 100;	endelse	Pbaro = Pbaro * ones(size(Pvap));end% CONVERT PVAP TO PASCAL IF IN MBAR% all non-nan valuesix = find( ~isnan(Pvap) );% are there some good values? then checkif length(ix) > 0,	if max(Pvap(ix)) < 120,		Pvap(ix) = Pvap(ix) .* 100;	endendMixR = 0.622 .* Pvap ./ (Pbaro - Pvap);return