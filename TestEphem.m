% Test Ephem routines% see Notes: Justos-65clearhrflt = [0:.1:24]';  uone = ones(size(hrflt));%alat = 40.8667 .* uone;		alon = -72.87817 .* uone;  	% BNLalat = 0 .* uone;		alon = 148 .* uone;  				% TWP%MM = 5 .* uone;   dd = 28 .* uone;  		% jd 148%MM = 2 .* uone;   dd = 6 .* uone;  			% jd 34MM = 3 .* uone;   dd = 10 .* uone;  		% equinoxmm = 0 .* uone;		ss = mm;yyyy = 1997 .* uone;jd = julian(yyyy,MM,dd) - julian(yyyy,1,1) + 1;% MINNETT/REYNOLDS fprintf('SolarRadiance\n');[s1, z1, a1] = solarradiance(alat, alon, jd, hrflt);% MATHER PENN STATEfprintf('SunAe\n');[a2, z2] = sunae(yyyy,jd, hrflt, alat, alon);% LONG/REYNOLDSfprintf('Ephem1.m\n');[s3, z3, a3] = ephems(alat, alon, yyyy, MM, dd, hrflt, 1);[a3, z3] = ephem1(yyyy, jd, hrflt, alat, alon);close all% COMPARE MINNETT AND MATHER ROUTINESfg = figure;subplot(2,1,1)plot(hrflt,z1,'-b',hrflt,z2,'r--');gridylabel('Zenith angle (deg)');set(gca,'ylim',[0,180], 'ytick',[0,45, 90, 135, 180, 225, 270, 315],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(2,1,2);plot(hrflt,a1,'-b',hrflt,a2,'r--');gridylabel('Azimuth (deg)');set(gca,'ylim',[0,360], 'ytick',[0,45, 90, 135, 180, 225, 270, 315],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(111);  figure(gcf);figure;subplot(2,1,1)plot(hrflt,z1-z2,'-k');gridylabel('z1-z2 (deg)');set(gca,'ylim',[-inf, inf],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(2,1,2);plot(hrflt,a1-a2,'-k');gridylabel('a1-a2 (deg)');set(gca,'ylim',[-inf, inf],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(111);  figure(gcf);% COMPARE MINNETT AND LONG (EPHEMS) ROUTINESfg = figure;subplot(2,1,1)plot(hrflt,z1,'-b',hrflt,z3,'r--');gridylabel('Zenith angle (deg)');set(gca,'ylim',[0,180], 'ytick',[0,45, 90, 135, 180, 225, 270, 315],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);title('COMPARE MINNETT AND LONG (EPHEMS)');subplot(2,1,2);plot(hrflt,a1,'-b',hrflt,a3,'r--');gridylabel('Azimuth (deg)');set(gca,'ylim',[0,360], 'ytick',[0,45, 90, 135, 180, 225, 270, 315],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(111);  figure(gcf);figure;subplot(2,1,1)plot(hrflt,z1-z3,'-k');gridylabel('z1-z3 (deg)');set(gca,'ylim',[-inf, inf],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);title('DIFFERENCES BETWEEN  MINNETT AND LONG (EPHEMS)');subplot(2,1,2);plot(hrflt,a1-a3,'-k');gridylabel('a1-a3 (deg)');set(gca,'ylim',[-inf, inf],...	'xlim',[0,24],'xtick',[0,3,6,9,12,15,18,21,24]);subplot(111);  figure(gcf);return