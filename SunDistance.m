function  [r, d,  dmean] = SunDistance(dt)%SUNDISTANCE - compute the sun earth distance ratio%	[r, d, dmean] = SunDistance(dt)%====================================================% The sun-earth distance ratio is used to correct the solar%constant.%% Taken from Schwindling et al.,1998, JGR, 103(C11),24919-24935.% who  attribute this to Paltridge and Platt, 1977, Radiative%Processes in Meteorology and Climatology, in "Developments%in Atmos. Science 5," Elsevier Sci., New york.%% ALTERNATIVE FROM JOE MICHALSKY, EMAIL 02030`% calculates r2 = (1/r)^2% g = (2 * pi * (jdf-1)) / 365;% r2 = 1.00011 + 0.034221 * cos(g) + 0.00128 * sin(g) + ...%   0.000719 * cos(2 * g) + 7.7e-5 * sin(2 * g);%input:% dt = datenum%output:% r = the ratio of the distance to the sun.% d = actual distance (km)% dmean = the mean distance, a constant. (km)%%reynolds 020311%==========================================================%TEST%clear, t0 = datenum(2002,1,1);%dt = t0 + [0:364]';dmean = 149597870.691;  % km ;  see http://neo.jpl.nasa.gov/glossary/au.html%=====================%COMPUTE THE JULIAN DAY%=====================[y,jdf] = dt2jdf(dt);% Schwindling%======================%SUN-EARTH DISTANCE IN AU%======================r1 = 1 - 0.01673 .* cos(0.017201 .* (jdf - 4));  % Schmindling eq 9 method% Michalsky method (computes (1/r)^2)g = (2 * pi * (jdf-1)) / 365;r2 = 1.00011 + 0.034221 * cos(g) + 0.00128 * sin(g) + ...  0.000719 * cos(2 * g) + 7.7e-5 * sin(2 * g);  % Michalsky methodr=r1;d = dmean * r;return