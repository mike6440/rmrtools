function [x, T] = RotationTransform(xrel, pitch, roll, az)%===================================================================%ROTATION TRANSFORM%   x = RotationTransform(xrel, pitch, roll, az)%%Computes the components of a vector in earth coordinates for any given%input% xrel is a 3x1 vector% pitch roll and azimuth are scalars%output% x = [3x1] vector%T = the rotation matrix to convert a vector in the platform frame%   to a vector in the earth fram of reference.% x = Ta .* Tr .* Tp .* xrel = T .* xrel%%angles in degrees.% pitch positive for bow up%roll positive for port up%azimuth in standard copass coordinates%===================================================================%reynolds 990710% TEST lines%clear% pitch = 2.0; roll = -2.0; az = 0.0;%pitch = [0 2 4 6 45 90]';  roll = [0 2 4 6 6 6]';  az = [0 0 0 0 0 0]';%xrel = [0,0,1]';d2r = pi/180;Sp = sin(pitch*d2r);  Cp = cos(pitch*d2r);Sr = sin(roll*d2r);   Cr = cos(roll*d2r);Sa = sin(az*d2r);     Ca = cos(az*d2r);% pitch transformTp = [1 0 00 Cp -Sp0 Sp Cp];% roll transformTr = [Cr 0 Sr0 1 0-Sr 0 Cr];% azimuth transformTa = [Ca Sa 0-Sa Ca 00 0 1];% complete transform% note: these are commutativeT = Ta * Tr * Tp;% The vector in the earth's frame of referencex = T * xrel;	return