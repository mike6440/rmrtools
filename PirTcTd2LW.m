function [lw, C_c, C_d] = PirTcTd2LW(e, tc, td, k);%function [lw, C_c, C_d] = PirTcTd2LW(e, tc, td, k);%----------------------------------------------------%%input%  e = thermopile computed flux in W/m^2%  tc = case degC%  td = dome degC%  k = calib coef, usually = 4.%  no arguments ==> test mode%output%  lw = corrected longwave flux, W/m^2%  C_c C_d = corrections for case and dome, w/m^2%-------------------------------------------------------%000928 changes eps to 0.98 per {fairall98}%010323 back to 1.0 per Fairall % THE CORRECTION IS BASED ON THE TEMPERATURES ONLYTc = tc+273.15;Td = td+273.15;eps = 1;sigma = 5.6704e-8;C_c = eps .* sigma .* Tc .^ 4;C_d =  - k .* sigma .* (Td .^ 4 - Tc .^ 4);lw = e + C_c + C_d;return%Examples: See Eppley user guide%K=4.18e-6                4.18e-6%v=-590e-6                200e-6 (1 mv)%tc=12.79                 12.79%td=14                    14%%pir = -141.1            47.8%C_c = 379.1             379.0%C_d = -25.8             -25.8%%lw = 212.06             401.06