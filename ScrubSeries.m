function [xclean, iclean] = ScrubSeries(x,clip),%SCRUBSERIES -- removes NaNs and values outside clip range%==============================================================%		[xclean, iclean] = ScrubSeries(x,clip),%input: %  x is the input nx1 vector%  clip is the 2 x 1 range of min,max allowable values%    note: clip is optional, default = [-inf,inf])%    if x < clip(1) or x > clip(2) it is eliminated%output:%  xclean is the new series with all NaNs and out of range points removed.%  iclean is the index in the x vector of all removed points.%Reynolds, 010212% edit 010112 - fix ability to handle a series all nans%==============================================================%============%Default clip%============if nargin == 1, clip = [-inf; inf]; endnpts = length(x);% find all bad valuesix = find( isnan(x) | x < clip(1) | x > clip(2) );if length(ix) > 0,  % some bad values to remove	x(ix) = [];	iclean = ix;else						% all values were good	iclean = NaN;end;%  if the series was all bad, iclean = []; Change to NaN.if length(x) == 0	x = NaN;	iclean = [1:npts]';endxclean = x;return