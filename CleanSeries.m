function [xclean, iclean] = CleanSeries(x,clip),%CLEANSERIES -- NaNs all numbers outside clip range%		[xclean, iclean] = CleanSeries(x,clip),%output series has same length as input series.%input: %  x is the input nx1 vector%  clip is the 2 x 1 range of min,max allowable values%output:%  xclean is the new series with all NaNs for out of range points removed.%  iclean is the index in the x vector of all NaN points.%Reynolds, 970219% find all bad valuesix = find( ~isnan(x) & ( x < clip(1) | x > clip(2) ));if length(ix) > 0,  % some bad values to remove	iclean = ix;	x(ix) = NaN * ones(size(ix));else						% all values were good	iclean = NaN;endxclean = x;return