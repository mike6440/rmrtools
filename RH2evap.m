function [Pvap, MixR] = RH2Evap(Temp, Pbaro, RH)%RH2Evap		vapor pressure over water given RH, T%			[Pvap, MixR] = RH2Evap(Temp, Pbaro, RH)%INPUT:  %  Temp = air temp (deg C or K)%  Pbaro = barometric pressure (mbar or Pa)%  RH = relative humidity (%);%Reynolds, 970204%Temp = [20,30]';%Pbaro = [1020,900]'%RH = [50,60]'if exist('Pbaro') ~= 1,   Pbaro = 1000end%  check if units are Pascals and convert to mbarif Pbaro < 1080;  Pbaro = Pbaro .* 100;end;%  check if temp is in degC and convert to Kif Temp < 150;  Temp = Temp + 273.16;end;%  check that RH in the range [0,100]if RH >= 100;  RH = 100;end;if RH < 0;  RH = 0;end;Pvapsat = esatwat(Temp);      % computes Pvap(saturated) in PascalsMixRsat = mixratio(Pvapsat, Pbaro);        % computes sat mix ratioMixR = RH ./ 100 .* MixRsat;a = MixR ./ 0.622;b = a ./ (1 + a);Pvap = Pbaro .* b;               % output in Pa. return