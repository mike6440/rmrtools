function   [rh,qsat] =  TairQP2RH(T, q, p)%function   [rh,qsat] =  TairQP2RH(T, q, p)%*******************************************************************%input%  T -- air temperature (C)%  q -- specific humidity (kg/kg)%  P -- barometric pressure (mbar), (optional, default = 1013)%%output%  RH -- %RH%  qsat-- saturated humidity at T%reynolds 160915%*******************************************************************if nargin == 2,  p = 1013;  endix=find(q>0.1); if length(ix)>0, q(ix)=q(ix)/1000; end%convert T to T kelvinTk = T + 273.15 * ones(size(T));%%% COMPUTE SATURATED VAPOR PRESSURE (PA)esat=EsatWat(T);%%%% COMPUTE RHwsat = 0.622 .* esat ./ (p - esat);w = q ./ (1-q);rh = (w ./ wsat) * 100;qsat = wsat ./ (ones(size(wsat)) + wsat);return;