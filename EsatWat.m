function es = EsatWat(tc)%function es = esatwat(tc)%  computes vapor pressure over water/ice%========================================================%% Input: %  tc -- column vector.%%Output: %  es (mbar or hPa) -- a column vector%% From Wikipedia%The formula presented by Buck[14] is commonly encountered in the literature %and provides a reasonable balance between complexity and accuracy[citation needed]:%%{{e^{*}}_{w}}=(1.0007+3.46\times 10^{-6}P)\times (6.1121)e^{\left({\frac {17.502T}%  {240.97+T}}\right)}%where %T is the dry bulb temperature expressed in degrees Celsius (°C), %P is the absolute pressure expressed in millibar, and %{{e^{*}}_{w}} is the equilibrium vapor pressure expressed in millibars. %Buck has reported that the maximum relative error is less than 0.20% between %-20 °C and +50 °C when this particular form of the generalized formula is used %to estimate the equilibrium vapor pressure of water.%%Reynolds, 981117, 010313%=======================================================a=6.1078;es=NaN(size(tc));% OVER WATERny = find(tc>=0);if length(ny)>0, 	c = 17.2694;	d = 237.3;	es(ny) = a .* exp(c .* tc(ny)  ./ (tc(ny) + d)); % mbarend% OVER ICEny=find(tc<0);if length(ny)>0,	c = 21.875;	d = 265.5;	es(ny) = a .* exp(c .* tc(ny)  ./ (tc(ny) + d)); % mbarendreturn