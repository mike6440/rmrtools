function [pth] = PlotColor(t,x,xt,cvec)%========================================================================%     [plothandle] = PlotColor(t,x,xt,cvec)%% PLots a line but if y < threshold it will be color 1 and if it is >% threshold it will be color.%%input:% 't' is the 'x' vector% 'x' is the 'y' (vertical vector)%  xt = threshold%  c vector is the colors according to the threshold%output:%  plothandle is an array of handles for all segments%  rmr 20061127%======================================================================== % COLUMN VECTORS[m,n] = size(x);  if n>1, x = x';  t = t';  endpth=[];% IDENTIFY THE SEGMENTS% THE FISRT POINTt1 = t(1); i1 = 1;  x1 = x(1);ta = [];  xa = [];for i = 2:length(x),	% TRANSITION UPWARD FROM REGION 1 TO REGION 2	if isnan(x(i)), 		i2 = i-1;		if x(i-1)<xt, c = cvec(1); else c = cvec(2); end		i2 = i-1;		ta = [ta; t(i1:i2)];		xa = [xa; x(i1:i2)];		pt = plot(ta,xa,c);		hold on		pth = [pth; pt];		%% find the next good point		ij = find(~isnan(x(i+1:end)));		if length(ij) > 0,			i = i + ij(1)-1;  ta = t(i); xa=x(i); 		else			break;		end	elseif x(i)>=xt && x(i-1)<xt,% 		disp('transition up');		i2 = i-1;		c = cvec(1);		ti = t(i-1) + (t(i)-t(i-1))*(xt-x(i-1))/(x(i)-x(i-1));		ta = [ta; t(i1:i-1); ti];		xa = [xa; x(i1:i-1); xt];		pt = plot(ta,xa,c);		hold on		pth = [pth; pt];		ta = ti;  xa = xt; i1 = i;	elseif x(i)<xt && x(i-1) >= xt,% 		disp('transition down');		i2 = i-1;		c = cvec(2);		ti = t(i-1) + (t(i)-t(i-1))*(xt-x(i-1))/(x(i)-x(i-1));		ta = [ta; t(i1:i-1); ti];		xa = [xa; x(i1:i-1); xt];		pt = plot(ta,xa,c);		hold on		pth = [pth; pt];		ta=ti;  xa = xt; i1 = i;	elseif i == length(x);% 		disp('end of series');		i2 = i;		if x(i)<xt, c = cvec(1); else c = cvec(2); end		ta = [ta; t(i1:end)];		xa = [xa; x(i1:end)];		pt = plot(ta,xa,c);		hold on		pth = [pth; pt];	endendhold offreturn