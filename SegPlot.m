function [handle, nsegs] = segplot(t,x,sty, MISSING)%=================================================% SEGPLOT			x-y plot lifting pen at Nan's%		[handle, nsegs] = segplot(t,x,sty, missing)%Inputs: % t = abscissa,  % x=ordinate, % sty = style string, 'r-'% missing = a value for a missing variable, e.g. -99 (optional)%			use inf for limits when self-scaling desired.%output% handle is the handle(s) to the segments% nsegs = number of different segments%===================================================% Reynolds, 980629if nargin < 4,	global MISSINGend%==================% FIND BAD PLACES%==================nx = length(x);igood = find( ~isnan(x) & x ~= MISSING );jmp = find(diff(igood)>1);i1 = [igood(1); igood(jmp+1)];i2 = [igood(jmp); igood(length(igood))];nsegs = length(i1);handle = [];if length(igood) == nx,   %================	% all points are good, do a simple plot	%================   handle = plot(t,x, sty);else,   %===================   %  LOOP OVER ALL LINE SEGMENTS   %===================   hold on   for iseg = 1:nsegs,      %fprintf('Segment %d, %d--%d\n',iseg, i1(iseg), i2(iseg));      h = plot(t(i1(iseg):i2(iseg)),x(i1(iseg):i2(iseg)),sty);      handle = [handle; h]; 	endendreturn