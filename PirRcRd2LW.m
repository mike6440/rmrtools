function [lw, Tc, Td, C_c, C_d] = PirRcRd2LW(e, rc, rd, k);%PIRCAL --   PIR CALIBRATION DATA%		[lw Tc Td C_c C_d] = PirRcRd2LW(e, rc, rd, k);%input%  e = thermopile computed flux in W/m^2%  rc = case resistance in ohms%  rd = dome resistance in ohms%  k = calib coef, usually = 4.%  no arguments ==> test mode%output%  lw = corrected longwave flux, W/m^2%  Tc, Td = case and dome temperatures in degC%  C_c C_d = corrections for case and dome, w/m^2%Reynolds%TEST -- no argumentsif nargin == 0	e = -30;   rc=10000;   rd=11000;   k=4;	fprintf('Test mode:e, rc, rd, k: %.1f, %.1f, %.1f, %.3f\n',...		e,rc,rd,k);	[lw, Tc, Td, C_c, C_d] = PirCal(e, rc, rd, k);	fprintf('Result: lw, Tc, Td, Cc, Cd: = %.1f, %.2f, %.2f, %.1f, %.1f\n',...		lw, Tc, Td, C_c, C_d);	return;end% TEMPERATURE IN DEG KTd = r2t(rd) + 273.15 .* ones(size(rd));  % degCTc = r2t(rc) + 273.15 .* ones(size(rc));  % degC% THE CORRECTION IS BASED ON THE TEMPERATURES ONLYeps = 1;sigma = 5.67e-8;C_c = eps .* sigma .* Tc .^ 4;C_d =  - k .* sigma .* (Td .^ 4 - Tc .^ 4);lw = e + C_c + C_d;Tc = Tc - 273.15;Td = Td - 273.15;return