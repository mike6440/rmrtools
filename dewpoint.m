function [tdew] = dewpoint(tair,rh, bp)% function [tdew] = dewpoint(tair,rh,bp)%INPUT:% tair = air temp in degC% rh = %rh 0-100%% bp = barometric pressure, mbar%OUTPUT% tdew = dewpoint in degC%% see: http://meted.ucar.edu/awips/validate/dewpnt.htm%1) Definition%%The dewpoint temperature defines the temperature which a parcel of air would%need to be cooled at constant pressure and constant moisture content inorder for%the vapor pressure and saturation vapor pressure of the parcel to be equal. In%other words, it's the temperature at which a parcel of air would be saturated%(i.e., 100% relative humidity).%%The above definition is taken from the Glossary of Meteorology. % Huschke, R. E., Ed., 1959: Glossary of Meteorology. Amer. Meteor. Soc., 638 pp.%%2) How to Calculate%%The standard AWIPS, empirically derived algorithm for dewpoint temperature is a%function of temperature and relative humidity. Temperature is used to find%saturation vapor pressure.%%Saturation vapor pressure is calculated as a function of temperature (deg K)%using a variation of the integrated form of the Clausius-Clapeyron equation. An%additional linear term is added to this value in order to give a better fit to%the measured relationship of saturation vapor pressure and temperature in the%Smithsonian Meteorological Tables.  Saturation vapor pressure is accurate to one%part in a thousand over the range from –25C to +35C.  The main advantage to%performing the calculation of in this manner is that it is invertible.   The%AWIPS formulation for calculating saturation vapor pressure is:%%	e_s = exp( C_15 - C_1 * T - C_2 / T)%     %Next, the relative humidity is used to calculated the vapor pressure. Vapor%pressure is then used in the empirical formula to calculate dewpoint%temperature.%%	e = RH * e_s%	b = C_15 - ln(e)%	T_d = [b - sqrt(b^2 - C_3) ]/ C_4%%where:%	• 	T = temperature (K)%	• 	RH = relative humidity (ratio)%	• 	b = intermediate place holder%	• 	C  15  = 26.66082%	• 	C  1  = 0.0091379024%	• 	C  2  = 6106.396%	• 	C  3  = 223.1986%	• 	C  4  = 0.0182758048%===========================================================================Tabs = 273.15;C15  = 26.66082;C1  = 0.0091379024;C2  = 6106.396;C3  = 223.1986;C4  = 0.0182758048;% CONVERT TO Ktairk = tair + Tabs;e_s = exp( C15 - C1 .* tairk - C2 ./ tairk);e = rh/100 .* e_s;b = C15 - log(e);tdew = [b - sqrt(b .^ 2 - C3) ] ./ C4;tdew = tdew-Tabs;